{% load static %}

{% if queryset.has_other_pages %}
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">

    <!-- Previous Page Link -->
    {% if queryset.has_previous %}
    <li class="page-item">
      <a class="page-link" href="?page={{ queryset.previous_page_number }}{% if form.q.value %}&amp;q={{ form.q.value|default_if_none:""|urlencode }}&amp;{% endif %}" aria-label="Previous">
        Previous
      </a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <span class="page-link" aria-label="Previous">Previous</span>
    </li>
    {% endif %}

    <!-- Page Numbers -->
    {% for n in queryset.paginator.page_range %}
    {% if n == queryset.number %}
    <!-- Current Page -->
    <li class="page-item active">
      <span class="page-link">
        {{ n }}
        <span class="sr-only">(current)</span>
      </span>
    </li>
    {% elif n >= queryset.number|add:'-2' and n <= queryset.number|add:'2' %}
    <!-- Pages within 2 of current page -->
    <li class="page-item">
      <a class="page-link" href="?page={{ n }}{% if form.q.value %}&amp;q={{ form.q.value|default_if_none:""|urlencode }}&amp;{% endif %}">{{ n }}</a>
    </li>
    {% elif n == 1 or n == queryset.paginator.num_pages %}
    <!-- First and Last pages -->
    <li class="page-item">
      <a class="page-link" href="?page={{ n }}{% if form.q.value %}&amp;q={{ form.q.value|default_if_none:""|urlencode }}&amp;{% endif %}">{{ n }}</a>
    </li>
    {% elif n == queryset.number|add:'-3' or n == queryset.number|add:'3' %}
    <!-- Ellipsis -->
    <li class="page-item disabled">
      <span class="page-link">...</span>
    </li>
    {% endif %}
    {% endfor %}

    <!-- Next Page Link -->
    {% if queryset.has_next %}
    <li class="page-item">
      <a class="page-link" href="?page={{ queryset.next_page_number }}{% if form.q.value %}&amp;q={{ form.q.value|default_if_none:""|urlencode }}&amp;{% endif %}" aria-label="Next">
        Next
      </a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <span class="page-link" aria-label="Next">Next</span>
    </li>
    {% endif %}

  </ul>
</nav>
{% endif %}
